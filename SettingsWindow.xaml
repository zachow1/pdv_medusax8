<Window x:Class="PDV_MedusaX8.SettingsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:sys="clr-namespace:System;assembly=mscorlib"
        mc:Ignorable="d"
        Title="Configurações"
        x:Name="SettingsWin"
        WindowStartupLocation="CenterScreen"
        ResizeMode="CanResize"
        SizeToContent="Manual"
        Width="800" Height="600"
        ShowInTaskbar="False"
        SizeChanged="SettingsWindow_SizeChanged">

    <Window.Resources>
        <sys:Double x:Key="BaseFontSize">12</sys:Double>
        <Thickness x:Key="BasePadding">10,10,10,10</Thickness>
        <!-- Paleta base -->
        <Color x:Key="CorFundoApp">#F7F8FB</Color>
        <Color x:Key="CorPrimariaAcao">#4F46E5</Color>
        <Color x:Key="CorFinalizar">#10B981</Color>
        <Color x:Key="CorCancelar">#EF4444</Color>
        <Color x:Key="CorTexto">#111827</Color>
        <SolidColorBrush x:Key="CorBorda" Color="#E5E7EB"/>
        <SolidColorBrush x:Key="BrFundoApp" Color="{StaticResource CorFundoApp}"/>
        <SolidColorBrush x:Key="BrPrimariaAcao" Color="{StaticResource CorPrimariaAcao}"/>
        <SolidColorBrush x:Key="BrFinalizar" Color="{StaticResource CorFinalizar}"/>
        <SolidColorBrush x:Key="BrCancelar" Color="{StaticResource CorCancelar}"/>
        <SolidColorBrush x:Key="BrTexto" Color="{StaticResource CorTexto}"/>
        <SolidColorBrush x:Key="BrTextoMutado" Color="#6B7280"/>
        <SolidColorBrush x:Key="BrCard" Color="#FFFFFF"/>

        <!-- Estilo de Button moderno (sem cantos arredondados, hover) -->
        <Style x:Key="ModernButton" TargetType="Button">
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Background" Value="{StaticResource BrPrimariaAcao}"/>
            <Setter Property="Padding" Value="10,6"/>
            <Setter Property="Margin" Value="0,0,8,0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                CornerRadius="0"
                                BorderBrush="{StaticResource CorBorda}" BorderThickness="0.5">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#6366F1"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Background" Value="#4338CA"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter Property="Opacity" Value="0.6"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Aplicar ModernButton como padrão para todos os botões -->
        <Style TargetType="Button" BasedOn="{StaticResource ModernButton}">
            <Setter Property="Height" Value="40"/>
            <Setter Property="Padding" Value="12,10"/>
        </Style>

        <!-- Estilo de TextBox baseado no AppInputTextBox (centralização e altura padronizada) -->
        <Style TargetType="TextBox" BasedOn="{StaticResource AppInputTextBox}">
            <Setter Property="Margin" Value="4"/>
            <Setter Property="BorderBrush" Value="#CBD5E1"/>
            <Setter Property="Background" Value="#FFFFFF"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="FontSize" Value="{DynamicResource BaseFontSize}"/>
            <Style.Triggers>
                <Trigger Property="IsKeyboardFocusWithin" Value="True">
                    <Setter Property="BorderBrush" Value="#4F46E5"/>
                </Trigger>
                <Trigger Property="IsEnabled" Value="False">
                    <Setter Property="Background" Value="#F3F4F6"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Estilo de GroupBox tipo card (título na mesma caixa) -->
        <Style TargetType="GroupBox">
            <Setter Property="Margin" Value="0,8,0,12"/>
            <Setter Property="Padding" Value="0"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="GroupBox">
                        <Border Background="{StaticResource BrCard}" BorderBrush="{StaticResource CorBorda}"
                                BorderThickness="1" CornerRadius="8" Padding="8">
                            <StackPanel>
                                <TextBlock Text="{TemplateBinding Header}" FontWeight="SemiBold" Foreground="{StaticResource BrPrimariaAcao}" Margin="0,0,0,8"/>
                                <ContentPresenter/>
                            </StackPanel>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Estilo de TextBlock para rótulos -->
        <Style x:Key="LabelText" TargetType="TextBlock">
            <Setter Property="Foreground" Value="{StaticResource BrTexto}"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="FontSize" Value="{DynamicResource BaseFontSize}"/>
        </Style>

        <!-- Slim blue switch-like CheckBox style -->
        <Style x:Key="SlimBlueCheckBox" TargetType="CheckBox">
            <Setter Property="Width" Value="36"/>
            <Setter Property="Height" Value="18"/>
            <Setter Property="Margin" Value="0"/>
            <Setter Property="HorizontalAlignment" Value="Center"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="CheckBox">
                        <Grid Width="36" Height="18">
                            <Border x:Name="SwitchTrack" CornerRadius="9" Background="#90CAF9" BorderBrush="#1976D2" BorderThickness="1"/>
                            <Ellipse x:Name="SwitchThumb" Width="16" Height="16" Fill="#1976D2" Margin="1,1,0,1" HorizontalAlignment="Left"/>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter TargetName="SwitchTrack" Property="Background" Value="#BBDEFB"/>
                                <Setter TargetName="SwitchThumb" Property="HorizontalAlignment" Value="Right"/>
                                <Setter TargetName="SwitchThumb" Property="Margin" Value="0,1,1,1"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter TargetName="SwitchTrack" Property="Opacity" Value="0.5"/>
                                <Setter TargetName="SwitchThumb" Property="Opacity" Value="0.5"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <ScrollViewer HorizontalScrollBarVisibility="Disabled" VerticalScrollBarVisibility="Auto">
        <Border Background="{StaticResource BrFundoApp}" BorderBrush="{StaticResource CorBorda}" BorderThickness="1" Padding="{StaticResource BasePadding}" CornerRadius="8">
                <DockPanel>
                    <TabControl>
                <TabItem Header="Forma de Pagamentos">
                    <Grid Margin="5">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <DataGrid Name="DgPaymentMethods" Grid.Row="0" AutoGenerateColumns="False" IsReadOnly="False"
                                  CanUserAddRows="False" CanUserDeleteRows="False"
                                  AllowDrop="True"
                                  CanUserSortColumns="False"
                                  PreviewMouseLeftButtonDown="DgPaymentMethods_PreviewMouseLeftButtonDown"
                                  MouseMove="DgPaymentMethods_MouseMove"
                                  DragOver="DgPaymentMethods_DragOver"
                                  Drop="DgPaymentMethods_Drop"
                                  CellEditEnding="DgPaymentMethods_CellEditEnding">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="Código" Binding="{Binding Code}" IsReadOnly="True" Width="120"/>
                                <DataGridTextColumn Header="Descrição" Binding="{Binding Name}" Width="*"/>
                                <DataGridTextColumn Header="Ordem" Binding="{Binding DisplayOrder, Mode=OneWay}" IsReadOnly="True" Width="80"/>
                                <DataGridCheckBoxColumn Header="Ativo" Binding="{Binding IsEnabled}" Width="80">
                                    <DataGridCheckBoxColumn.ElementStyle>
                                        <Style TargetType="CheckBox" BasedOn="{StaticResource SlimBlueCheckBox}"/>
                                    </DataGridCheckBoxColumn.ElementStyle>
                                    <DataGridCheckBoxColumn.EditingElementStyle>
                                        <Style TargetType="CheckBox" BasedOn="{StaticResource SlimBlueCheckBox}"/>
                                    </DataGridCheckBoxColumn.EditingElementStyle>
                                </DataGridCheckBoxColumn>
                                <DataGridComboBoxColumn Header="Vínculo" Width="120"
                                                        SelectedItemBinding="{Binding LinkType, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                        ItemsSource="{Binding ElementName=SettingsWin, Path=LinkTypes}"/>
                            </DataGrid.Columns>
                        </DataGrid>

                        <StackPanel Grid.Row="1" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,10,0,0">
            <Button Content="Salvar" Background="{StaticResource BrFinalizar}" Foreground="White" Click="SavePayments" Padding="8,0,8,0"/>
            <Button Content="Cancelar" Margin="8,0,0,0" Background="{StaticResource BrCancelar}" Foreground="White" Click="CloseSettings" Padding="8,0,8,0"/>
                        </StackPanel>
                    </Grid>
                </TabItem>

                <TabItem Header="NFC-e">
                    <Grid Margin="10">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        
                        <StackPanel Grid.Row="0" Orientation="Vertical" Margin="0,0,0,10">
                            <TextBlock Text="Configurações de NFC-e" FontWeight="Bold" Margin="0,0,0,8"/>
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,0,0,8">
                                <Button x:Name="BtnToggleNFCeEdit" Content="Habilitar Edição" Click="ToggleNFCeEdit_Click" Padding="10,4" Background="{StaticResource BrCancelar}" Foreground="White"/>
                            </StackPanel>
                            
                            <StackPanel Orientation="Horizontal" Margin="0,4,0,0">
                                <TextBlock Text="Certificado:" Width="120" VerticalAlignment="Center"/>
                                <TextBox Name="TxtCert" IsReadOnly="True" Width="400" VerticalContentAlignment="Center" Padding="10,2"/>
                                <Button x:Name="BtnSelectCert" Content="Selecionar..." Margin="8,0,0,0" Click="SelectCert_Click"/>
                            </StackPanel>

                            <StackPanel Orientation="Horizontal" Margin="0,4,0,0">
                                <TextBlock Text="Ambiente:" Width="120" VerticalAlignment="Center"/>
                                <ComboBox Name="CmbEnvironment" Width="200" SelectedValuePath="Content">
                                    <ComboBoxItem Content="Homolog"/>
                                    <ComboBoxItem Content="Producao"/>
                                </ComboBox>
                            </StackPanel>

                            <StackPanel Orientation="Horizontal" Margin="0,4,0,0">
                                <TextBlock Text="Número do caixa:" Width="120" VerticalAlignment="Center"/>
                                <TextBox Name="TxtCashRegister" Width="120" PreviewTextInput="NumericOnly_PreviewTextInput" VerticalContentAlignment="Center" Padding="10,2"/>
                            </StackPanel>

                            <StackPanel Orientation="Horizontal" Margin="0,4,0,0">
                                <TextBlock Text="Série NFC-e:" Width="120" VerticalAlignment="Center"/>
                                <TextBox Name="TxtSerie" Width="120" PreviewTextInput="NumericOnly_PreviewTextInput" VerticalContentAlignment="Center" Padding="10,2"/>
                            </StackPanel>

                            <StackPanel Orientation="Horizontal" Margin="0,4,0,0">
                                <TextBlock Text="Próxima nota:" Width="120" VerticalAlignment="Center"/>
                                <TextBox Name="TxtNextNumber" Width="120" PreviewTextInput="NumericOnly_PreviewTextInput" VerticalContentAlignment="Center" Padding="10,2"/>
                            </StackPanel>

                            <StackPanel Orientation="Horizontal" Margin="0,4,0,0">
                                <TextBlock Text="CSC Id:" Width="120" VerticalAlignment="Center"/>
                                <TextBox Name="TxtCSCId" Width="160" VerticalContentAlignment="Center" Padding="10,2"/>
                            </StackPanel>

                            <StackPanel Orientation="Horizontal" Margin="0,4,0,0">
                                <TextBlock Text="CSC:" Width="120" VerticalAlignment="Center"/>
                                <TextBox Name="TxtCSC" Width="320" VerticalContentAlignment="Center" Padding="10,2"/>
                            </StackPanel>
                        </StackPanel>

                        <StackPanel Grid.Row="1" Orientation="Horizontal" HorizontalAlignment="Right">
        <Button Content="Salvar" Click="SaveNFCeConfig_Click" Background="{StaticResource BrFinalizar}" Foreground="White" Padding="8,0,8,0"/>
                        </StackPanel>
                    </Grid>
                </TabItem>

                <!-- NOVA ABA: TEF -->
                <TabItem Header="TEF">
                    <Grid Margin="10">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <StackPanel Grid.Row="0" Orientation="Vertical" Margin="0,0,0,10">
                            <TextBlock Text="Configurações de TEF" FontWeight="Bold" Margin="0,0,0,8"/>
                            <StackPanel Orientation="Horizontal" Margin="0,4,0,0">
                                <TextBlock Text="Tipo de Integração:" Width="150" VerticalAlignment="Center"/>
                                <ComboBox Name="CmbTEFType" Width="260" SelectedValuePath="Content">
                                    <ComboBoxItem Content="Nenhum"/>
                                    <ComboBoxItem Content="Sitef (CliSiTef)"/>
                                    <ComboBoxItem Content="PayGo"/>
                                    <ComboBoxItem Content="Cappta"/>
                                    <ComboBoxItem Content="Stone"/>
                                    <ComboBoxItem Content="VeSPague"/>
                                    <ComboBoxItem Content="Scope"/>
                                    <ComboBoxItem Content="TPag"/>
                                    <ComboBoxItem Content="Elgin"/>
                                    <ComboBoxItem Content="Banese"/>
                                    <ComboBoxItem Content="Discado"/>
                                </ComboBox>
                            </StackPanel>

                            <!-- Campo genérico: Scope -->
                            <StackPanel Orientation="Horizontal" Margin="0,6,0,0">
                                <TextBlock Text="Scope:" Width="150" VerticalAlignment="Center"/>
                                <TextBox Name="TxtTEFScope" Width="260"/>
                            </StackPanel>

                            <!-- Campos específicos do SiTef -->
                            <TextBlock Text="Configurações SiTef (CliSiTef)" FontWeight="Bold" Margin="0,12,0,4"/>
                            <StackPanel Orientation="Horizontal" Margin="0,4,0,0">
                                <TextBlock Text="SiTef IP:" Width="150" VerticalAlignment="Center"/>
                                <TextBox Name="TxtSitefIP" Width="260"/>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,4,0,0">
                                <TextBlock Text="SiTef Loja:" Width="150" VerticalAlignment="Center"/>
                                <TextBox Name="TxtSitefLoja" Width="260"/>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,4,0,0">
                                <TextBlock Text="SiTef Terminal:" Width="150" VerticalAlignment="Center"/>
                                <TextBox Name="TxtSitefTerminal" Width="260"/>
                            </StackPanel>

                            <!-- Pasta de Troca -->
                            <StackPanel Orientation="Horizontal" Margin="0,8,0,0">
                                <TextBlock Text="Pasta de Troca (TEF):" Width="150" VerticalAlignment="Center"/>
                                <TextBox Name="TxtTEFExchangePath" Width="260"/>
                            </StackPanel>
                        </StackPanel>

                        <StackPanel Grid.Row="1" Orientation="Horizontal" HorizontalAlignment="Right">
                            <CheckBox Name="ChkTEFDebug" Content="Modo Debug (gerar resposta local)" VerticalAlignment="Center" Margin="0,0,16,0"/>
                            <Button Content="Testar TEF (Debug)" Click="DebugTEF_Click" Background="{StaticResource BrFinalizar}" Foreground="White" Margin="0,0,8,0"/>
        <Button Content="Salvar" Click="SaveTEFConfig_Click" Background="{StaticResource BrFinalizar}" Foreground="White" Padding="8,0,8,0"/>
                        </StackPanel>
                    </Grid>
                </TabItem>

                

                <TabItem Header="Opções">
                    <Grid Margin="10">
                        <Grid.Resources>
                            <!-- Estilo switch para CheckBox no formulário de opções -->
                            <Style TargetType="CheckBox">
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="CheckBox">
                                            <DockPanel LastChildFill="False">
                                                <Grid Width="44" Height="24" DockPanel.Dock="Left">
                                                    <Border x:Name="Track" Background="#E5E7EB" CornerRadius="12"/>
                                                    <Border x:Name="Thumb" Width="20" Height="20" Background="White" CornerRadius="10" HorizontalAlignment="Left" Margin="2"/>
                                                </Grid>
                                                <ContentPresenter Margin="8,0,0,0" VerticalAlignment="Center" RecognizesAccessKey="True"/>
                                            </DockPanel>
                                            <ControlTemplate.Triggers>
                                                <Trigger Property="IsChecked" Value="True">
                                                    <Setter TargetName="Track" Property="Background" Value="#4F46E5"/>
                                                    <Setter TargetName="Thumb" Property="HorizontalAlignment" Value="Right"/>
                                                </Trigger>
                                                <Trigger Property="IsEnabled" Value="False">
                                                    <Setter Property="Opacity" Value="0.6"/>
                                                </Trigger>
                                            </ControlTemplate.Triggers>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                            </Style>
                        </Grid.Resources>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        <!-- Reorganização: três abas internas: Geral | Supervisor | Imagem -->
                        <Grid Grid.Row="0" Margin="0,0,0,10">
                            <TabControl>
                                <TabItem Header="Geral">
                                    <Grid Margin="0,10,0,0">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <StackPanel Grid.Column="0" Orientation="Vertical">
                                            <CheckBox Name="ChkEnableF9" Content="Permitir alterar preço unitário com F9"/>
                                            <CheckBox Name="ChkPromptConsumer" Content="Solicitar consumidor ao iniciar a venda?"/>
                                            <CheckBox Name="ChkRequireF2ToStartSale" Content="Exigir F2 para iniciar venda"/>
                                            <CheckBox Name="ChkImportERPOrders" Content="Importar pedido de venda do ERP"/>
                                            <CheckBox Name="ChkEnableBlindCashClosure" Content="Habilitar Conferência às Cegas"/>
                                        </StackPanel>
                                        <StackPanel Grid.Column="1" Orientation="Vertical" Margin="20,0,0,0">
                                            <TextBlock Text="Desconto máximo (%)" VerticalAlignment="Center"/>
                                            <TextBox Name="TxtMaxDiscountPercent" Width="100"/>
                                        </StackPanel>
                                    </Grid>
                                </TabItem>
                                <TabItem Header="Supervisor">
                                    <StackPanel Margin="8" Orientation="Vertical">
                                        <CheckBox Name="ChkRequireSupervisorForSangria" Content="Exigir supervisor para Sangria"/>
                                        <CheckBox Name="ChkRequireSupervisorForOpeningCash" Content="Exigir supervisor para Abrir Caixa"/>
                                        <CheckBox Name="ChkRequireSupervisorForClosingCash" Content="Exigir supervisor para Fechar Caixa"/>
                                    </StackPanel>
                                </TabItem>
                                <TabItem Header="Imagem">
                                    <StackPanel Margin="8" Orientation="Vertical">
                                        <StackPanel Orientation="Horizontal" Margin="0,4,0,0">
                                            <TextBlock Text="Arquivo de imagem:" Width="120" VerticalAlignment="Center"/>
                                            <TextBox Name="TxtLogoPath" Width="200" IsReadOnly="True" Margin="0,0,8,0"/>
                                            <Button Name="BtnSelectLogo" Content="Selecionar..." Click="SelectLogo_Click" Padding="8,4"/>
                                            <Button Name="BtnRemoveLogo" Content="Remover" Click="RemoveLogo_Click" Margin="8,0,0,0" Padding="8,4"/>
                                        </StackPanel>
                                        <StackPanel Orientation="Horizontal" Margin="0,8,0,0">
                                            <TextBlock Text="Preview:" Width="120" VerticalAlignment="Top"/>
                                            <Border Name="LogoPreviewBorder" Width="150" Height="100" BorderBrush="#CBD5E1" BorderThickness="1" CornerRadius="4" Background="#F8F9FA">
                                                <Image Name="LogoPreview" Stretch="Uniform" Margin="4"/>
                                            </Border>
                                        </StackPanel>
                                        <CheckBox Name="ChkShowLogo" Content="Exibir logo na área principal" Margin="0,8,0,0"/>
                                    </StackPanel>
                                </TabItem>
                            </TabControl>
                        </Grid>
                        <StackPanel Grid.Row="1" Orientation="Horizontal" HorizontalAlignment="Right">
                            <Button Content="Salvar Opções" Click="SaveOptions_Click" Background="{StaticResource BrFinalizar}" Foreground="White"/>
                        </StackPanel>
                    </Grid>
                </TabItem>

                <!-- Nova aba: Produto Fácil -->
                <TabItem Header="Produto Fácil">
                    <Grid Margin="10">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <StackPanel Grid.Row="0" Orientation="Vertical" Margin="0,0,0,10">
                            <TextBlock Text="Produtos vinculados à tela Produto Fácil" FontWeight="Bold" Margin="0,0,0,8"/>
                            <ListView Name="LstProdutoFacil" Height="Auto">
                                <ListView.View>
                                    <GridView>
                                        <GridViewColumn Header="Código" Width="120" DisplayMemberBinding="{Binding Code}"/>
                                        <GridViewColumn Header="Descrição" Width="300" DisplayMemberBinding="{Binding Description}"/>
                                        <GridViewColumn Header="Preço" Width="100" DisplayMemberBinding="{Binding PriceFormatted}"/>
                                    </GridView>
                                </ListView.View>
                            </ListView>
                        </StackPanel>

                        <StackPanel Grid.Row="1" Orientation="Horizontal" HorizontalAlignment="Right">
                            <Button Content="Adicionar Produto" Margin="0,0,8,0" Click="AddProdutoFacil_Click" Background="{StaticResource BrFinalizar}" Foreground="White"/>
                            <Button Content="Remover Selecionado" Click="RemoveProdutoFacil_Click" Background="{StaticResource BrCancelar}" Foreground="White"/>
                        </StackPanel>
                    </Grid>
                </TabItem>

                <!-- Nova aba: Impressão -->
                <TabItem Header="Impressão">
                    <Grid Margin="10">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <StackPanel Grid.Row="0" Orientation="Vertical" Margin="0,0,0,10">
                            <TextBlock Text="Selecionar impressoras por tipo de documento" FontWeight="Bold" Margin="0,0,0,8"/>

                            <StackPanel Orientation="Horizontal" Margin="0,4,0,0">
                                <TextBlock Text="Boleto:" Width="180" VerticalAlignment="Center"/>
                                <ComboBox Name="CmbPrinterBoleto" Width="300"/>
                            </StackPanel>

                            <StackPanel Orientation="Horizontal" Margin="0,4,0,0">
                                <TextBlock Text="Confissão de dívida:" Width="180" VerticalAlignment="Center"/>
                                <ComboBox Name="CmbPrinterConfissao" Width="300"/>
                            </StackPanel>

                            <StackPanel Orientation="Horizontal" Margin="0,4,0,0">
                                <TextBlock Text="NFCe:" Width="180" VerticalAlignment="Center"/>
                                <ComboBox Name="CmbPrinterNFCe" Width="300"/>
                            </StackPanel>

                            <Separator Margin="0,10,0,10"/>
                            <TextBlock Text="Carnê (Crédito em Loja)" FontWeight="Bold"/>

                            <StackPanel Orientation="Horizontal" Margin="0,4,0,0">
                                <TextBlock Text="Impressora 80mm:" Width="180" VerticalAlignment="Center"/>
                                <ComboBox Name="CmbPrinterCarne80" Width="300"/>
                            </StackPanel>

                            <StackPanel Orientation="Horizontal" Margin="0,4,0,0">
                                <TextBlock Text="Impressora A4:" Width="180" VerticalAlignment="Center"/>
                                <ComboBox Name="CmbPrinterCarneA4" Width="300"/>
                            </StackPanel>

                            <StackPanel Orientation="Horizontal" Margin="0,8,0,0">
                                <TextBlock Text="Formato padrão do Carnê:" Width="180" VerticalAlignment="Center"/>
                                <ComboBox Name="CmbCarneFormatoPadrao" Width="160" SelectedValuePath="Content">
                                    <ComboBoxItem Content="80mm"/>
                                    <ComboBoxItem Content="A4"/>
                                </ComboBox>
                            </StackPanel>
                        </StackPanel>

                        <StackPanel Grid.Row="1" Orientation="Horizontal" HorizontalAlignment="Right">
                            <Button Content="Salvar Impressoras" Background="{StaticResource BrFinalizar}" Foreground="White" Click="SavePrinterSettings_Click"/>
                        </StackPanel>
                    </Grid>
                </TabItem>

                <!-- Nova aba: Empresa -->
                <TabItem Header="Empresa">
                    <Grid Margin="10">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <!-- Detalhes -->
                        <TabControl Grid.Row="1">
                            <TabItem Header="Geral">
                                <DockPanel>
                                    <ScrollViewer DockPanel.Dock="Top" VerticalScrollBarVisibility="Auto">
                                        <!-- Sub-abas: Dados Gerais | Endereço -->
                                        <TabControl Margin="8">
                                            <TabItem Header="Dados Gerais">
                                                <Grid Margin="8">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="Auto"/>
                                                        <ColumnDefinition Width="2*"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                        <ColumnDefinition Width="2*"/>
                                                    </Grid.ColumnDefinitions>
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                    </Grid.RowDefinitions>

                                                    <TextBlock Text="Razão Social" Grid.Row="0" Grid.Column="0" VerticalAlignment="Center"/>
        <TextBox x:Name="TxtEmpresaRazaoSocial" Grid.Row="0" Grid.Column="1" Margin="4" IsReadOnly="True"/>
                                                    <TextBlock Text="Nome Fantasia" Grid.Row="0" Grid.Column="2" VerticalAlignment="Center"/>
        <TextBox x:Name="TxtEmpresaNomeFantasia" Grid.Row="0" Grid.Column="3" Margin="4" IsReadOnly="True"/>

                                                    <TextBlock Text="CNPJ" Grid.Row="1" Grid.Column="0" VerticalAlignment="Center"/>
        <TextBox x:Name="TxtEmpresaCNPJ" Grid.Row="1" Grid.Column="1" Margin="4" MaxLength="14" PreviewTextInput="NumericOnly_PreviewTextInput" TextChanged="CNPJ_TextChanged" LostFocus="CNPJ_Validate_LostFocus" ToolTip="Somente dígitos (14)" IsReadOnly="True"/>
                                                    <TextBlock Text="IE" Grid.Row="1" Grid.Column="2" VerticalAlignment="Center"/>
        <TextBox x:Name="TxtEmpresaIE" Grid.Row="1" Grid.Column="3" Margin="4" IsReadOnly="True"/>

                                                    <TextBlock Text="IM" Grid.Row="2" Grid.Column="0" VerticalAlignment="Center"/>
        <TextBox x:Name="TxtEmpresaIM" Grid.Row="2" Grid.Column="1" Margin="4" IsReadOnly="True"/>
                                                    <TextBlock Text="Regime Tributário" Grid.Row="2" Grid.Column="2" VerticalAlignment="Center"/>
        <ComboBox x:Name="TxtEmpresaRegimeTributario" Grid.Row="2" Grid.Column="3" Margin="4" SelectedValuePath="Content" IsEditable="False" IsEnabled="False">
                                                        <ComboBoxItem Content="Simples Nacional"/>
                                                        <ComboBoxItem Content="Lucro Presumido"/>
                                                        <ComboBoxItem Content="Lucro Real"/>
                                                        <ComboBoxItem Content="MEI"/>
                                                        <ComboBoxItem Content="Outros"/>
                                                    </ComboBox>

                                                    <TextBlock Text="CNAE" Grid.Row="3" Grid.Column="0" VerticalAlignment="Center"/>
        <TextBox x:Name="TxtEmpresaCNAE" Grid.Row="3" Grid.Column="1" Margin="4" IsReadOnly="True"/>
                                                    <TextBlock Text="Email" Grid.Row="3" Grid.Column="2" VerticalAlignment="Center"/>
        <TextBox x:Name="TxtEmpresaEmail" Grid.Row="3" Grid.Column="3" Margin="4" IsReadOnly="True"/>

                                                    <TextBlock Text="Telefone" Grid.Row="4" Grid.Column="0" VerticalAlignment="Center"/>
        <TextBox x:Name="TxtEmpresaTelefone" Grid.Row="4" Grid.Column="1" Margin="4" MaxLength="11" PreviewTextInput="NumericOnly_PreviewTextInput" TextChanged="Telefone_TextChanged" ToolTip="DDD+Número (somente dígitos)" IsReadOnly="True"/>
                                                    <TextBlock Text="Website" Grid.Row="4" Grid.Column="2" VerticalAlignment="Center"/>
        <TextBox x:Name="TxtEmpresaWebsite" Grid.Row="4" Grid.Column="3" Margin="4" IsReadOnly="True"/>
                                                </Grid>
                                            </TabItem>
                                            <TabItem Header="Endereço">
                                                <Grid Margin="8">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="Auto"/>
                                                        <ColumnDefinition Width="2*"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                        <ColumnDefinition Width="1.5*"/>
                                                    </Grid.ColumnDefinitions>
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                    </Grid.RowDefinitions>

                                                    <TextBlock Text="CEP" Grid.Row="0" Grid.Column="0" VerticalAlignment="Center"/>
        <TextBox x:Name="TxtEmpresaCEP" Grid.Row="0" Grid.Column="1" Margin="4" MaxLength="8" PreviewTextInput="NumericOnly_PreviewTextInput" TextChanged="CEP_TextChanged" ToolTip="Somente dígitos (8)" IsReadOnly="True"/>
                                                    <TextBlock Text="Logradouro" Grid.Row="0" Grid.Column="2" VerticalAlignment="Center"/>
        <TextBox x:Name="TxtEmpresaLogradouro" Grid.Row="0" Grid.Column="3" Margin="4" IsReadOnly="True"/>

                                                    <TextBlock Text="Número" Grid.Row="1" Grid.Column="0" VerticalAlignment="Center"/>
        <TextBox x:Name="TxtEmpresaNumero" Grid.Row="1" Grid.Column="1" Margin="4" MaxLength="6" PreviewTextInput="NumericOnly_PreviewTextInput" IsReadOnly="True"/>
                                                    <TextBlock Text="Complemento" Grid.Row="1" Grid.Column="2" VerticalAlignment="Center"/>
        <TextBox x:Name="TxtEmpresaComplemento" Grid.Row="1" Grid.Column="3" Margin="4" IsReadOnly="True"/>

                                                    <TextBlock Text="Bairro" Grid.Row="2" Grid.Column="0" VerticalAlignment="Center"/>
        <TextBox x:Name="TxtEmpresaBairro" Grid.Row="2" Grid.Column="1" Margin="4" IsReadOnly="True"/>
                                                    <TextBlock Text="Município Código" Grid.Row="2" Grid.Column="2" VerticalAlignment="Center"/>
        <TextBox x:Name="TxtEmpresaMunicipioCodigo" Grid.Row="2" Grid.Column="3" Margin="4" MaxLength="7" PreviewTextInput="NumericOnly_PreviewTextInput" IsReadOnly="True"/>

                                                    <TextBlock Text="Município Nome" Grid.Row="3" Grid.Column="0" VerticalAlignment="Center"/>
                                                    <Grid Grid.Row="3" Grid.Column="1" Margin="4">
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="*"/>
                                                            <ColumnDefinition Width="Auto"/>
                                                        </Grid.ColumnDefinitions>
        <TextBox x:Name="TxtEmpresaMunicipioNome" Grid.Column="0" HorizontalAlignment="Stretch" IsReadOnly="True"/>
        <Button Grid.Column="1" Content="Buscar..." Margin="8,0,0,0" Click="SelectEmpresaMunicipio_Click" IsEnabled="False"/>
                                                    </Grid>
                                                    <TextBlock Text="UF" Grid.Row="3" Grid.Column="2" VerticalAlignment="Center"/>
        <ComboBox x:Name="TxtEmpresaUF" Grid.Row="3" Grid.Column="3" Margin="4" IsEditable="False" SelectedValuePath="Content" IsEnabled="False">
                                                        <ComboBoxItem Content="AC"/><ComboBoxItem Content="AL"/><ComboBoxItem Content="AP"/><ComboBoxItem Content="AM"/>
                                                        <ComboBoxItem Content="BA"/><ComboBoxItem Content="CE"/><ComboBoxItem Content="DF"/><ComboBoxItem Content="ES"/>
                                                        <ComboBoxItem Content="GO"/><ComboBoxItem Content="MA"/><ComboBoxItem Content="MT"/><ComboBoxItem Content="MS"/>
                                                        <ComboBoxItem Content="MG"/><ComboBoxItem Content="PA"/><ComboBoxItem Content="PB"/><ComboBoxItem Content="PR"/>
                                                        <ComboBoxItem Content="PE"/><ComboBoxItem Content="PI"/><ComboBoxItem Content="RJ"/><ComboBoxItem Content="RN"/>
                                                        <ComboBoxItem Content="RS"/><ComboBoxItem Content="RO"/><ComboBoxItem Content="RR"/><ComboBoxItem Content="SC"/>
                                                        <ComboBoxItem Content="SP"/><ComboBoxItem Content="SE"/><ComboBoxItem Content="TO"/>
                                                    </ComboBox>
                                                </Grid>
                                            </TabItem>
                                        </TabControl>
                                    </ScrollViewer>
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="8" DockPanel.Dock="Bottom">
    <Button Content="Salvar Empresa" Margin="0,0,8,0" Click="SaveEmpresa_Click" IsEnabled="False"/>
                                    </StackPanel>
                                </DockPanel>
                            </TabItem>
                            <TabItem Header="Contador">
                                <DockPanel>
                                    <ScrollViewer DockPanel.Dock="Top" VerticalScrollBarVisibility="Auto">
                                        <StackPanel>
                                            <Grid>
                                                <Grid>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                    </Grid.ColumnDefinitions>
                                                    <CheckBox x:Name="ChkEmpresaContabil" Grid.Column="1" Content="Empresa Contábil" Margin="8" IsChecked="True" Checked="ChkEmpresaContabil_Checked" Unchecked="ChkEmpresaContabil_Unchecked"/>
                                                </Grid>
                                            </Grid>
                                            <TabControl Margin="8">
                                                        <TabItem Header="Dados do contador">
                                                            <TabControl Margin="0">
                                                                <TabItem Header="Dados">
                                                                    <Grid Margin="8">
                                                                        <Grid.ColumnDefinitions>
                                                                            <ColumnDefinition Width="Auto"/>
                                                                            <ColumnDefinition Width="2.5*"/>
                                                                            <ColumnDefinition Width="Auto"/>
                                                                            <ColumnDefinition Width="2*"/>
                                                                            <ColumnDefinition Width="Auto"/>
                                                                            <ColumnDefinition Width="2*"/>
                                                                        </Grid.ColumnDefinitions>
                                                                        <Grid.RowDefinitions>
                                                                            <RowDefinition Height="Auto"/>
                                                                            <RowDefinition Height="Auto"/>
                                                                            <RowDefinition Height="Auto"/>
                                                                            <RowDefinition Height="Auto"/>
                                                                        </Grid.RowDefinitions>
                                                                        <TextBlock Text="Nome" Grid.Row="0" Grid.Column="0" VerticalAlignment="Center"/>
                                                                        <TextBox x:Name="TxtContadorNome" Grid.Row="0" Grid.Column="1" Margin="4" IsReadOnly="True"/>

                                                                        <TextBlock Text="CPF" Grid.Row="1" Grid.Column="0" VerticalAlignment="Center"/>
                                                                        <TextBox x:Name="TxtContadorCPF" Grid.Row="1" Grid.Column="1" Margin="4" MaxLength="11" PreviewTextInput="NumericOnly_PreviewTextInput" TextChanged="CPF_TextChanged" LostFocus="CPF_Validate_LostFocus" ToolTip="Somente dígitos (11)" IsReadOnly="True"/>
                                                                        <TextBlock Text="Email" Grid.Row="1" Grid.Column="2" VerticalAlignment="Center"/>
                                                                        <TextBox x:Name="TxtContadorEmail" Grid.Row="1" Grid.Column="3" Margin="4" IsReadOnly="True"/>

                                                                        <TextBlock Text="Telefone" Grid.Row="2" Grid.Column="0" VerticalAlignment="Center"/>
                                                                        <TextBox x:Name="TxtContadorTelefone" Grid.Row="2" Grid.Column="1" Margin="4" MaxLength="11" PreviewTextInput="NumericOnly_PreviewTextInput" TextChanged="Telefone_TextChanged" ToolTip="DDD+Número (somente dígitos)" IsReadOnly="True"/>

                                                                        <TextBlock Text="Estado (CRC)" Grid.Row="3" Grid.Column="0" VerticalAlignment="Center"/>
                                                                        <ComboBox x:Name="CmbContadorEstadoCRC" Grid.Row="3" Grid.Column="1" Margin="4" MinWidth="140" IsEditable="False" SelectedValuePath="Content" IsEnabled="False">
                                                                            <ComboBoxItem Content="AC"/><ComboBoxItem Content="AL"/><ComboBoxItem Content="AP"/><ComboBoxItem Content="AM"/>
                                                                            <ComboBoxItem Content="BA"/><ComboBoxItem Content="CE"/><ComboBoxItem Content="DF"/><ComboBoxItem Content="ES"/>
                                                                            <ComboBoxItem Content="GO"/><ComboBoxItem Content="MA"/><ComboBoxItem Content="MT"/><ComboBoxItem Content="MS"/>
                                                                            <ComboBoxItem Content="MG"/><ComboBoxItem Content="PA"/><ComboBoxItem Content="PB"/><ComboBoxItem Content="PR"/>
                                                                            <ComboBoxItem Content="PE"/><ComboBoxItem Content="PI"/><ComboBoxItem Content="RJ"/><ComboBoxItem Content="RN"/>
                                                                            <ComboBoxItem Content="RS"/><ComboBoxItem Content="RO"/><ComboBoxItem Content="RR"/><ComboBoxItem Content="SC"/>
                                                                            <ComboBoxItem Content="SP"/><ComboBoxItem Content="SE"/><ComboBoxItem Content="TO"/>
                                                                        </ComboBox>
                                                                        <TextBlock Text="CRC" Grid.Row="3" Grid.Column="2" VerticalAlignment="Center"/>
                                                                        <TextBox x:Name="TxtContadorCRC" Grid.Row="3" Grid.Column="3" Margin="4" MinWidth="140" IsReadOnly="True"/>

                                                                        <TextBlock Text="Tipo CRC" Grid.Row="3" Grid.Column="4" VerticalAlignment="Center"/>
                                                                        <ComboBox x:Name="CmbContadorCRCTipo" Grid.Row="3" Grid.Column="5" Margin="4" MinWidth="140" IsEditable="False" SelectedValuePath="Content" IsEnabled="False">
                                                                            <ComboBoxItem Content="Originário"/><ComboBoxItem Content="Transferido"/><ComboBoxItem Content="Provisório"/>
                                                                        </ComboBox>
                                                                    </Grid>
                                                                </TabItem>
                                                        <TabItem Header="Endereços">
                                                            <Grid Margin="8">
                                                                <Grid.ColumnDefinitions>
                                                                    <ColumnDefinition Width="Auto"/>
                                                                    <ColumnDefinition Width="2*"/>
                                                                    <ColumnDefinition Width="Auto"/>
                                                                    <ColumnDefinition Width="1.5*"/>
                                                                </Grid.ColumnDefinitions>
                                                                <Grid.RowDefinitions>
                                                                    <RowDefinition Height="Auto"/>
                                                                    <RowDefinition Height="Auto"/>
                                                                    <RowDefinition Height="Auto"/>
                                                                    <RowDefinition Height="Auto"/>
                                                                    <RowDefinition Height="Auto"/>
                                                                </Grid.RowDefinitions>

                                                                <TextBlock Text="Celular" Grid.Row="0" Grid.Column="0" VerticalAlignment="Center"/>
                                                                <TextBox x:Name="TxtContadorCelular" Grid.Row="0" Grid.Column="1" Margin="4" MaxLength="11" PreviewTextInput="NumericOnly_PreviewTextInput" TextChanged="Telefone_TextChanged" ToolTip="DDD+Número (somente dígitos)" IsReadOnly="True"/>
                                                                <TextBlock Text="CEP" Grid.Row="0" Grid.Column="2" VerticalAlignment="Center"/>
                                                                <TextBox x:Name="TxtContadorCEP" Grid.Row="0" Grid.Column="3" Margin="4" MaxLength="8" PreviewTextInput="NumericOnly_PreviewTextInput" TextChanged="CEP_TextChanged" ToolTip="Somente dígitos (8)" IsReadOnly="True"/>

                                                                <TextBlock Text="Logradouro" Grid.Row="1" Grid.Column="0" VerticalAlignment="Center"/>
                                                                <TextBox x:Name="TxtContadorLogradouro" Grid.Row="1" Grid.Column="1" Margin="4" IsReadOnly="True"/>
                                                                <TextBlock Text="Número" Grid.Row="1" Grid.Column="2" VerticalAlignment="Center"/>
                                                                <TextBox x:Name="TxtContadorNumero" Grid.Row="1" Grid.Column="3" Margin="4" MaxLength="6" PreviewTextInput="NumericOnly_PreviewTextInput" IsReadOnly="True"/>

                                                                <TextBlock Text="Complemento" Grid.Row="2" Grid.Column="0" VerticalAlignment="Center"/>
                                                                <TextBox x:Name="TxtContadorComplemento" Grid.Row="2" Grid.Column="1" Margin="4" IsReadOnly="True"/>
                                                                <TextBlock Text="Bairro" Grid.Row="2" Grid.Column="2" VerticalAlignment="Center"/>
                                                                <TextBox x:Name="TxtContadorBairro" Grid.Row="2" Grid.Column="3" Margin="4" IsReadOnly="True"/>

                                                                <TextBlock Text="Município Código" Grid.Row="3" Grid.Column="0" VerticalAlignment="Center"/>
                                                                <TextBox x:Name="TxtContadorMunicipioCodigo" Grid.Row="3" Grid.Column="1" Margin="4" MaxLength="7" PreviewTextInput="NumericOnly_PreviewTextInput" IsReadOnly="True"/>
                                                                <TextBlock Text="Município Nome" Grid.Row="3" Grid.Column="2" VerticalAlignment="Center"/>
                                                                <Grid Grid.Row="3" Grid.Column="3" Margin="4">
                                                                    <Grid.ColumnDefinitions>
                                                                        <ColumnDefinition Width="*"/>
                                                                        <ColumnDefinition Width="Auto"/>
                                                                    </Grid.ColumnDefinitions>
                                                                    <TextBox x:Name="TxtContadorMunicipioNome" Grid.Column="0" HorizontalAlignment="Stretch" IsReadOnly="True"/>
                                                                    <Button Grid.Column="1" Content="Buscar..." Margin="8,0,0,0" IsEnabled="False"/>
                                                                </Grid>

                                                                <TextBlock Text="UF" Grid.Row="4" Grid.Column="0" VerticalAlignment="Center"/>
                                                                <ComboBox x:Name="TxtContadorUF" Grid.Row="4" Grid.Column="1" Margin="4" IsEditable="False" SelectedValuePath="Content" IsEnabled="False">
                                                                    <ComboBoxItem Content="AC"/><ComboBoxItem Content="AL"/><ComboBoxItem Content="AP"/><ComboBoxItem Content="AM"/>
                                                                    <ComboBoxItem Content="BA"/><ComboBoxItem Content="CE"/><ComboBoxItem Content="DF"/><ComboBoxItem Content="ES"/>
                                                                    <ComboBoxItem Content="GO"/><ComboBoxItem Content="MA"/><ComboBoxItem Content="MT"/><ComboBoxItem Content="MS"/>
                                                                    <ComboBoxItem Content="MG"/><ComboBoxItem Content="PA"/><ComboBoxItem Content="PB"/><ComboBoxItem Content="PR"/>
                                                                    <ComboBoxItem Content="PE"/><ComboBoxItem Content="PI"/><ComboBoxItem Content="RJ"/><ComboBoxItem Content="RN"/>
                                                                    <ComboBoxItem Content="RS"/><ComboBoxItem Content="RO"/><ComboBoxItem Content="RR"/><ComboBoxItem Content="SC"/>
                                                                    <ComboBoxItem Content="SP"/><ComboBoxItem Content="SE"/><ComboBoxItem Content="TO"/>
                                                                </ComboBox>
                                                            </Grid>
                                                        </TabItem>
                                                    </TabControl>
                                                </TabItem>
                                                <TabItem x:Name="TabEmpresaContabil" Header="Empresa Contábil" Visibility="Visible">
                                                    <Grid Margin="8">
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="Auto"/>
                                                            <ColumnDefinition Width="2.5*"/>
                                                            <ColumnDefinition Width="Auto"/>
                                                            <ColumnDefinition Width="2*"/>
                                                        </Grid.ColumnDefinitions>
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="Auto"/>
                                                            <RowDefinition Height="Auto"/>
                                                            <RowDefinition Height="Auto"/>
                                                        </Grid.RowDefinitions>
                                                        <TabControl Margin="0">
                                                    <TabItem Header="Dados">
                                                        <Grid Margin="8">
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="Auto"/>
                                                                <ColumnDefinition Width="2*"/>
                                                                <ColumnDefinition Width="Auto"/>
                                                                <ColumnDefinition Width="1.5*"/>
                                                                <ColumnDefinition Width="Auto"/>
                                                                <ColumnDefinition Width="1.5*"/>
                                                            </Grid.ColumnDefinitions>
                                                            <Grid.RowDefinitions>
                                                                <RowDefinition Height="Auto"/>
                                                                <RowDefinition Height="Auto"/>
                                                                <RowDefinition Height="Auto"/>
                                                            </Grid.RowDefinitions>
                                                                    <TextBlock Text="Empresa" Grid.Row="0" Grid.Column="0" VerticalAlignment="Center"/>
                                                                    <TextBox x:Name="TxtEmpresaContabilNome" Grid.Row="0" Grid.Column="1" Margin="6" MinWidth="220" IsReadOnly="True"/>
                                                                    <TextBlock Text="CNPJ" Grid.Row="0" Grid.Column="2" VerticalAlignment="Center"/>
                                                                    <TextBox x:Name="TxtEmpresaContabilCNPJ" Grid.Row="0" Grid.Column="3" Margin="6" MinWidth="180" MaxLength="14" PreviewTextInput="NumericOnly_PreviewTextInput" ToolTip="Somente dígitos (14)" IsReadOnly="True"/>

                                                                    <TextBlock Text="Email" Grid.Row="1" Grid.Column="0" VerticalAlignment="Center"/>
                                                                    <TextBox x:Name="TxtEmpresaContabilEmail" Grid.Row="1" Grid.Column="1" Margin="6" MinWidth="220" IsReadOnly="True"/>
                                                                    <TextBlock Text="Telefone" Grid.Row="1" Grid.Column="2" VerticalAlignment="Center"/>
                                                                    <TextBox x:Name="TxtEmpresaContabilTelefone" Grid.Row="1" Grid.Column="3" Margin="6" MinWidth="180" MaxLength="11" PreviewTextInput="NumericOnly_PreviewTextInput" TextChanged="Telefone_TextChanged" ToolTip="DDD+Número (somente dígitos)" IsReadOnly="True"/>

                                                                    <TextBlock Text="Estado (CRC)" Grid.Row="2" Grid.Column="0" VerticalAlignment="Center"/>
                                                                    <ComboBox x:Name="CmbEmpresaContabilEstadoCRC" Grid.Row="2" Grid.Column="1" Margin="6" MinWidth="100" IsEditable="False" SelectedValuePath="Content" IsEnabled="False">
                                                                        <ComboBoxItem Content="AC"/><ComboBoxItem Content="AL"/><ComboBoxItem Content="AP"/><ComboBoxItem Content="AM"/>
                                                                        <ComboBoxItem Content="BA"/><ComboBoxItem Content="CE"/><ComboBoxItem Content="DF"/><ComboBoxItem Content="ES"/>
                                                                        <ComboBoxItem Content="GO"/><ComboBoxItem Content="MA"/><ComboBoxItem Content="MT"/><ComboBoxItem Content="MS"/>
                                                                        <ComboBoxItem Content="MG"/><ComboBoxItem Content="PA"/><ComboBoxItem Content="PB"/><ComboBoxItem Content="PR"/>
                                                                        <ComboBoxItem Content="PE"/><ComboBoxItem Content="PI"/><ComboBoxItem Content="RJ"/><ComboBoxItem Content="RN"/>
                                                                        <ComboBoxItem Content="RS"/><ComboBoxItem Content="RO"/><ComboBoxItem Content="RR"/><ComboBoxItem Content="SC"/>
                                                                        <ComboBoxItem Content="SP"/><ComboBoxItem Content="SE"/><ComboBoxItem Content="TO"/>
                                                                    </ComboBox>
                                                                    <TextBlock Text="CRC" Grid.Row="2" Grid.Column="2" VerticalAlignment="Center"/>
                                                                    <TextBox x:Name="TxtEmpresaContabilCRC" Grid.Row="2" Grid.Column="3" Margin="6" MinWidth="120" IsReadOnly="True"/>

                                                                <TextBlock Text="Tipo CRC" Grid.Row="2" Grid.Column="4" VerticalAlignment="Center"/>
                                                                <ComboBox x:Name="CmbEmpresaContabilCRCTipo" Grid.Row="2" Grid.Column="5" Margin="6" MinWidth="100" IsEditable="False" SelectedValuePath="Content" IsEnabled="False">
                                                                    <ComboBoxItem Content="Originário"/><ComboBoxItem Content="Transferido"/><ComboBoxItem Content="Provisório"/>
                                                                </ComboBox>
                                                            </Grid>
                                                        </TabItem>
                                                        <TabItem Header="Endereços">
                                                            <Grid Margin="8">
                                                                <Grid.ColumnDefinitions>
                                                                    <ColumnDefinition Width="Auto"/>
                                                                    <ColumnDefinition Width="3*"/>
                                                                    <ColumnDefinition Width="Auto"/>
                                                                    <ColumnDefinition Width="2*"/>
                                                                </Grid.ColumnDefinitions>
                                                                    <Grid.RowDefinitions>
                                                                        <RowDefinition Height="Auto"/>
                                                                        <RowDefinition Height="Auto"/>
                                                                        <RowDefinition Height="Auto"/>
                                                                        <RowDefinition Height="Auto"/>
                                                                        <RowDefinition Height="Auto"/>
                                                                    </Grid.RowDefinitions>

                                                                <TextBlock Text="CEP" Grid.Row="0" Grid.Column="0" VerticalAlignment="Center"/>
                                                                <TextBox x:Name="TxtEmpresaContabilCEP" Grid.Row="0" Grid.Column="1" Margin="4" MinWidth="120" MaxLength="8" PreviewTextInput="NumericOnly_PreviewTextInput" TextChanged="CEP_TextChanged" ToolTip="Somente dígitos (8)" IsReadOnly="True"/>

                                                                <TextBlock Text="Logradouro" Grid.Row="1" Grid.Column="0" VerticalAlignment="Center"/>
                                                                <TextBox x:Name="TxtEmpresaContabilLogradouro" Grid.Row="1" Grid.Column="1" Margin="4" MinWidth="260" IsReadOnly="True"/>
                                                                <TextBlock Text="Número" Grid.Row="1" Grid.Column="2" VerticalAlignment="Center"/>
                                                                <TextBox x:Name="TxtEmpresaContabilNumero" Grid.Row="1" Grid.Column="3" Margin="4" MinWidth="100" MaxLength="6" PreviewTextInput="NumericOnly_PreviewTextInput" IsReadOnly="True"/>

                                                                <TextBlock Text="Complemento" Grid.Row="2" Grid.Column="0" VerticalAlignment="Center"/>
                                                                <TextBox x:Name="TxtEmpresaContabilComplemento" Grid.Row="2" Grid.Column="1" Margin="4" MinWidth="200" IsReadOnly="True"/>
                                                                <TextBlock Text="Bairro" Grid.Row="2" Grid.Column="2" VerticalAlignment="Center"/>
                                                                <TextBox x:Name="TxtEmpresaContabilBairro" Grid.Row="2" Grid.Column="3" Margin="4" MinWidth="180" IsReadOnly="True"/>

                                                                    <TextBlock Text="Município Código" Grid.Row="3" Grid.Column="0" VerticalAlignment="Center"/>
                                                                    <TextBox x:Name="TxtEmpresaContabilMunicipioCodigo" Grid.Row="3" Grid.Column="1" Margin="4" MaxLength="7" PreviewTextInput="NumericOnly_PreviewTextInput" IsReadOnly="True"/>
                                                                    <TextBlock Text="Município Nome" Grid.Row="3" Grid.Column="2" VerticalAlignment="Center"/>
                                                                    <Grid Grid.Row="3" Grid.Column="3" Margin="4">
                                                                        <Grid.ColumnDefinitions>
                                                                            <ColumnDefinition Width="*"/>
                                                                            <ColumnDefinition Width="Auto"/>
                                                                        </Grid.ColumnDefinitions>
                                                                        <TextBox x:Name="TxtEmpresaContabilMunicipioNome" Grid.Column="0" HorizontalAlignment="Stretch" MinWidth="220" IsReadOnly="True"/>
                                                                        <Button Grid.Column="1" Content="Buscar..." Margin="8,0,0,0" IsEnabled="False"/>
                                                                    </Grid>

                                                                    <TextBlock Text="UF" Grid.Row="4" Grid.Column="0" VerticalAlignment="Center"/>
                                                                    <ComboBox x:Name="TxtEmpresaContabilUF" Grid.Row="4" Grid.Column="1" Margin="4" IsEditable="False" SelectedValuePath="Content" IsEnabled="False">
                                                                        <ComboBoxItem Content="AC"/><ComboBoxItem Content="AL"/><ComboBoxItem Content="AP"/><ComboBoxItem Content="AM"/>
                                                                        <ComboBoxItem Content="BA"/><ComboBoxItem Content="CE"/><ComboBoxItem Content="DF"/><ComboBoxItem Content="ES"/>
                                                                        <ComboBoxItem Content="GO"/><ComboBoxItem Content="MA"/><ComboBoxItem Content="MT"/><ComboBoxItem Content="MS"/>
                                                                        <ComboBoxItem Content="MG"/><ComboBoxItem Content="PA"/><ComboBoxItem Content="PB"/><ComboBoxItem Content="PR"/>
                                                                        <ComboBoxItem Content="PE"/><ComboBoxItem Content="PI"/><ComboBoxItem Content="RJ"/><ComboBoxItem Content="RN"/>
                                                                        <ComboBoxItem Content="RS"/><ComboBoxItem Content="RO"/><ComboBoxItem Content="RR"/><ComboBoxItem Content="SC"/>
                                                                        <ComboBoxItem Content="SP"/><ComboBoxItem Content="SE"/><ComboBoxItem Content="TO"/>
                                                                    </ComboBox>
                                                                </Grid>
                                                            </TabItem>
                                                        </TabControl>
                                                    </Grid>
                                                </TabItem>
                                            </TabControl>
                                        </StackPanel>
                                        </ScrollViewer>
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="8" DockPanel.Dock="Bottom">
    <Button Content="Salvar Contador" Click="SaveContador_Click" IsEnabled="False"/>
                                    </StackPanel>
                                </DockPanel>
                            </TabItem>
                        </TabControl>

                        <!-- Botões de sincronização removidos: já existe formulário dedicado para isso -->
                    </Grid>
                </TabItem>
                    </TabControl>
                </DockPanel>
        </Border>
    </ScrollViewer>
</Window>